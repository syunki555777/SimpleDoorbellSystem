# 📊 進捗管理システム

## 概要

このプロジェクトは、**Flask**を使用して構築された **進捗管理システム** です。班ごとにタスクの進捗を管理し、必要に応じて特定の班を呼び出す機能を提供します。また、管理者向けの管理機能や外部APIを通じた操作もサポートしています。

---

## 主な機能
以下のような機能を提供します。

- **班ごとのタスク管理**
    - 各班の現在の進捗状況を確認可能。
    - タスク完了操作や取り消しが可能。
    - 次に進めるべきタスクを表示。

- **呼び出し機能**
    - 班ごとに「呼び出し理由」を指定してリクエストを作成。
    - 管理者がリクエストを確認し、処理が完了したら削除する機能。

- **管理者向け機能**
    - 全班の進捗状況や呼び出しリクエストを一括管理。
    - 各班の進捗状況を更新またはリセット可能。

- **外部APIサポート**
    - 外部システムから進捗や呼び出しリクエストを操作可能なAPIを提供。

## 使用方法

### 1. 必要な環境構築
以下を事前にインストールしてください。

- **Python 3.12**
- 必須ライブラリ（Flask 等）
  ```bash
  pip install Flask
  ```

### 2. 実行方法

アプリケーションを実行するには、以下のコマンドを使用します。

```bash
python app.py
```

デフォルトでは、アプリケーションはローカルホスト (`http://127.0.0.1:5000`) で動作します。

---

## 主なルートと機能

### ユーザー向け
- `/` : トップページ。班のタスクと進捗状況を表示します。
- `/group/<group_id>` : 指定された班の進捗を表示・操作するページ。
- `/confirm/<group_id>/<task>` : タスク完了操作の確認ページ。
- `/confirm_call/<group_id>/<reason>` : 呼び出しリクエスト確認ページ。

### APIエンドポイント
- `/api/call/<group_id>/<reason>` : 任意の班を呼び出すAPI (`POST` リクエスト)。
- `/api/task/<group_id>` : 次のタスクを完了状態に更新するAPI (`POST` リクエスト)。
- `/api/task/<group_id>/undo` : 最後に完了したタスクを取り消すAPI (`POST` リクエスト)。

### 管理者向け
- `/admin` : 管理者専用インターフェース。全班の進捗状況と呼び出しリクエストを管理。
- `/update_progress` : 管理者がタスクのステータスを更新するエンドポイント。
- `/clear_progress/<group_id>` : 指定された班の進捗をリセットするエンドポイント。
- `/get_progress` : 全班の進捗状況をJSON形式で取得するAPI。
- `/get_call_requests` : 全ての呼び出しリクエストをJSON形式で取得するAPI。
- `/complete_call_request` : 指定された呼び出しリクエストを処理完了として削除。

---

## カスタマイズのポイント

以下の定数を適宜変更してください。

- **トークン設定**
  - `SECRET_TOKEN`: 管理者専用のトークン。
  - `STUDENT_TOKEN`: 班の進捗管理画面用のトークン。
  - `REMOTE_TOKEN`: 外部API用のトークン。

- **タスクと班設定**
  - `NUMBER_OF_GROUPS`: 班の総数 (例: 14)。
  - `TASKS`: 管理するタスク一覧 (例: `["課題1", "課題2"]`)。
  - `CALL_REASONS`: 呼び出しで使用可能な理由リスト。

---

## セキュリティ

- 各エンドポイントはトークンを使用して認証しています。適切に変更・管理してください。
- トークン値は**公開しないでください**。

---
### 注意事項
- インメモリデータベースを使用しています。途中で動作を停止すると、呼び出し内容が消えますのでご注意ください。
- 汎用性の観点から、呼び出し理由について厳格なチェックをしていません。POST内容の文言がそのまま掲載されます。
- 班番号は班の総数によらず無制限に作成することができます。